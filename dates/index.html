<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../favicon.png">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Working with dates - Grist Help Center</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <link href="../css/grist.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Overview", url: "#_top", children: [
          ]},
          {title: "Parsing dates from strings and back", url: "#parsing-dates-from-strings-and-back", children: [
          ]},
          {title: "Date arithmetic", url: "#date-arithmetic", children: [
          ]},
          {title: "Getting a part of the date", url: "#getting-a-part-of-the-date", children: [
              {title: "Option A", url: "#option-a" },
              {title: "Option B", url: "#option-b" },
          ]},
          {title: "Additional resources", url: "#additional-resources", children: [
          ]},
        ];

    </script>
    <script src="../js/base.js"></script>
      <script src="../js/grist.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../functions/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../functions/" class="btn btn-xs btn-link">
        Function reference
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../lookup-formulas/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../lookup-formulas/" class="btn btn-xs btn-link">
        Lookup formulas
      </a>
    </div>
    
  </div>

    

    <h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p>Grist supports both Date and DateTime column types. Both support different formatting options, and
DateTime can also specify the timezone. When a column is set to be a Date or a DateTime, a
datepicker widget allows you to select the date with a UI.</p>
<p>When working with dates in formulas, the dates are Python <a href="https://docs.python.org/2/library/datetime.html">datetime
objects</a>. That allows you to do some powerful
things, but can be unexpected if you're not familiar with them.</p>
<h2 id="parsing-dates-from-strings-and-back">Parsing dates from strings and back<a class="headerlink" href="#parsing-dates-from-strings-and-back" title="Permanent link">#</a></h2>
<p>The <a href="functions/#datevalue">DATEVALUE</a> function converts a string that represents a date into a <code>datetime</code>
object. It's simple to use and it will auto-detect different date formats:</p>
<p><img alt="Parse date from string datevalue" src="../images/dates-parse-datevalue.png" /></p>
<p>You can also use Python's <code>datetime</code> library, which provides two helpful functions:
<a href="https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior">strptime() and strftime()</a>.</p>
<p>For example, let's say you have a table of United States Presidents and their inauguration dates (as
strings). You'd like to parse out the actual date to be able to sort the table properly. Here's how
you would do that:</p>
<p><img alt="Parse date from string formula" src="../images/dates-parse-string-formula.png" /></p>
<ol>
<li>First line imports the datetime library</li>
<li>The second line splits the string into two parts and returns the second part (Python arrays are
   zero-based).</li>
<li>The third line uses Python's <a href="https://docs.python.org/2/library/datetime.html#datetime.datetime.strptime">strptime
   function</a> to parse
   the date (e.g. "March 4, 1861") into a datetime object. The first parameter to the function is
   the string to parse, the second parameter is the date format that the string is in. Take a look
   at the <a href="https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior">format
   options</a> to see if
   the example format string <code>%B %d, %Y</code> makes sense. (Note: You could've also used <code>DATEVALUE(d)</code> to
   achieve the same result.)</li>
</ol>
<p>The result looks to have proper date formats and can now be properly sorted, with George Washington
at the top:</p>
<p><img alt="Parse date from string result" src="../images/dates-parse-string-sorted.png" /></p>
<p>And, because the column type is selected as a date, you can use the "Date Format" in "Field Options"
to select the format in which to display the date.</p>
<p><span style="white-space: nowrap;">
<img alt="Formatted parsed date" src="../images/dates-parse-string-formatted.png" />
<img alt="Formatted parsed date" src="../images/dates-parse-string-options.png" />
</span></p>
<h2 id="date-arithmetic">Date arithmetic<a class="headerlink" href="#date-arithmetic" title="Permanent link">#</a></h2>
<p>Once you have a proper date column, often you'll want to do date arithmetic such as calculating the
difference between two dates. The simplest way to do this is to use the <a href="formulas/#datedif">DATEDIF</a>
function which takes two dates and the unit of information to return (Days, Months, or Years).</p>
<p>You could also use the minus sign to subtract two dates, but you might be surprised at the result:</p>
<p><span style="white-space: nowrap;">
<img alt="Subtract a date" src="../images/dates-subtract-formula.png" />
<img alt="Date subtraction surprise" src="../images/dates-subtract-surprise.png" />
</span></p>
<p>This happens because subtracting two dateime objects as we did in the example above, results in a
<a href="https://docs.python.org/2/library/datetime.html#datetime.timedelta">datetime.timedelta</a> object
which represents, "A duration expressing the difference between two date, time, or datetime
instances to microsecond resolution."</p>
<p>In Grist (and Python) you have to be more specific above how you want to display the date
difference. For example, to get the number of days from the returned timedelta object, use its
<code>.days</code> property:</p>
<p><span style="white-space: nowrap;">
<img alt="Timedelta formula days" src="../images/dates-timedelta-formula.png" />
<img alt="Timedelta formula results" src="../images/dates-timedelta-results.png" />
</span></p>
<p>If you want weeks or years, just divide by 7 or by 365. If you want hours, multiply by 24.</p>
<p>You can also use specific functions to get what you want. For example, <code>DAYS</code> is a common function
in spreadsheet apps that returns the difference between two dates:
<span style="white-space: nowrap;">
<img alt="Days formula" src="../images/dates-formula-days.png" />
<img alt="Timedelta formula results" src="../images/dates-timedelta-results.png" />
</span></p>
<div class="admonition note">
<p class="admonition-title">Excel/Sheets formulas</p>
<p>Grist supports many other common functions from other spreadsheet apps, including
<code>DATEADD</code>, <code>DATEDIF</code>, <code>DATEVALUE</code>, <code>MONTH</code>, <code>HOUR</code>, and <a href="functions/#date">many more</a>.</p>
</div>
<h2 id="getting-a-part-of-the-date">Getting a part of the date<a class="headerlink" href="#getting-a-part-of-the-date" title="Permanent link">#</a></h2>
<p>You've seen how to parse the date, display it in different formats, and do date arithmetic. But what
if you want to get more information about a specific date, such as getting its day of the week?</p>
<h3 id="option-a">Option A<a class="headerlink" href="#option-a" title="Permanent link">#</a></h3>
<p>The best option is to use the <a href="functions/#weekday">WEEKDAY</a> function, which behaves as it does in
Excel:</p>
<p><span style="white-space: nowrap;">
<img alt="Weekday formula" src="../images/dates-weekday-formula.png" />
<img alt="Weekday results" src="../images/dates-weekday-results.png" />
</span></p>
<p>Because <a href="functions/#weekday">WEEKDAY</a> function returns 1–7 for Sunday–Saturday, George Washington
started his term on Thursday, John Adams on Saturday, and Thomas Jefferson on Wednesday.</p>
<h3 id="option-b">Option B<a class="headerlink" href="#option-b" title="Permanent link">#</a></h3>
<p>Another option is to simply reformat the date using Date Format in Field options. First, set the
"Day of week" column to be equal to "First day" column:</p>
<p><img alt="Weekday format copy" src="../images/dates-weekday-format-copy.png" /></p>
<p>Then set a custom Date Format in Field options. Consulting the <a href="https://momentjs.com/docs/#/displaying/format/">date formatting
reference</a> we can see <code>dddd</code> returns the long form
of the weekday (i.e. Monday, Tuesday, …):</p>
<p><span style="white-space: nowrap;">
<img alt="Weekday format options" src="../images/dates-weekday-format-options.png" />
<img alt="Weekday format results" src="../images/dates-weekday-format-results.png" />
</span></p>
<div class="admonition warning">
<p class="admonition-title">Value versus display</p>
<p>These two options are not equivalent, even though they produce a seemingly similar result. In
Option A, the column value is the weekday. In Option B, however, the column value is the actual
date (e.g. April 30th, 1789) and the weekday displayed is only the formatting. If you wanted to
summarize by the "Day of week" column to find the most popular day to begin a presidency, only
Option A would work.</p>
</div>
<h2 id="additional-resources">Additional resources<a class="headerlink" href="#additional-resources" title="Permanent link">#</a></h2>
<ul>
<li><a href="http://strftime.org">Python cheatsheet for strftime</a></li>
<li><a href="https://momentjs.com/docs/#/displaying/format/">Date formatting cheatsheet</a></li>
</ul>

  <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>