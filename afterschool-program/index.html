<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../images/favicon.png">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Manage business data - Grist Help Center</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <link href="../css/grist.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Intro", url: "#_top", children: [
              {title: "Planning", url: "#planning" },
              {title: "Data Modeling", url: "#data-modeling" },
              {title: "Classes and Instructors", url: "#classes-and-instructors" },
              {title: "Formulas", url: "#formulas" },
              {title: "References", url: "#references" },
              {title: "Students", url: "#students" },
              {title: "Many-to-Many Relationships", url: "#many-to-many-relationships" },
              {title: "Class View", url: "#class-view" },
              {title: "Enrollment View", url: "#enrollment-view" },
              {title: "Adding Layers", url: "#adding-layers" },
              {title: "Example Document", url: "#example-document" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script>
      <script src="../js/grist.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../creating-doc/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../creating-doc/" class="btn btn-xs btn-link">
        Creating a document
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../investment-research/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../investment-research/" class="btn btn-xs btn-link">
        Analyze and visualize
      </a>
    </div>
    
  </div>

    

    <h1 id="how-to-manage-business-data">How to manage business data<a class="headerlink" href="#how-to-manage-business-data" title="Permanent link">#</a></h1>
<p>Grist shines when your business data has some complexity. In this example, we’ll look at an
organization that runs after-school activities for children.</p>
<p>Feel free to refer to the &ldquo;Afterschool Program&rdquo; example document in Examples &amp; Templates in your
Grist home page.</p>
<p>In this exercise we will show how to go about planning, designing, and creating such document.</p>
<h2 id="planning">Planning<a class="headerlink" href="#planning" title="Permanent link">#</a></h2>
<p>A little planning ahead will help you get a solution faster. Think about what kinds of data you
are working with, and what kinds of workflows you will need. You don&rsquo;t need to anticipate
everything when you start. You can easily add complexity later, as you&rsquo;ll see below.</p>
<p>Our organization runs a number of classes for children. Each class has an instructor and multiple
students. Students may enroll in multiple classes, and may return year after year. For each class,
we&rsquo;ll want to see the list of enrolled students, and if there are spots available. When a parent
calls, we want a convenient way to enroll a new student, or to change or cancel a student&rsquo;s
enrollment.</p>
<p>If this sounds like building an application, that&rsquo;s exactly what we are doing. As you&rsquo;ll see,
however, it is no harder than building a spreadsheet.</p>
<h2 id="data-modeling">Data Modeling<a class="headerlink" href="#data-modeling" title="Permanent link">#</a></h2>
<p>The better you model your business data, the easier your work will be. In a way, you are doing
database design as well as building a custom application. Grist just makes it easier.</p>
<p>Let&rsquo;s start with the classes and their instructors.</p>
<p>We need a list of classes and instructors. The same instructor can teach different classes, so
instructors and classes will live in different tables. Let’s call them &ldquo;Classes&rdquo; and &ldquo;Staff&rdquo;. Each
class has a single instructor, so one of the properties of a class will be that class’s
instructor.</p>
<h2 id="classes-and-instructors">Classes and Instructors<a class="headerlink" href="#classes-and-instructors" title="Permanent link">#</a></h2>
<p>When starting from scratch, you&rsquo;ll create a new empty document (see <a href="../creating-doc/">Creating a
document</a>), rename the initial empty table &ldquo;Table1&rdquo; to &ldquo;Classes&rdquo;, add the columns
you need, and type in some classes. To follow the steps of this tutorial, you can instead import
<a data-wm-adjusted="1" href="/afterschool-program/Classes.csv">Classes.csv</a>
(or simply refer to the &ldquo;Afterschool Program&rdquo; example document).</p>
<p><img alt="add-classes" src="../images/afterschool-program/add-classes.png" /></p>
<p>For the Staff table, click the &ldquo;Add New&rdquo; button and select &ldquo;Add Empty Table&rdquo;. Rename it to
&ldquo;Staff&rdquo;, create some columns, and enter some data about instructors. Or import
<a href="/afterschool-program/Staff.csv">Staff.csv</a> to use sample data and save a few steps.</p>
<p><img alt="add-staff" src="../images/afterschool-program/add-staff.png" /></p>
<p>We want the <em>Instructor</em> column in the <code>Classes</code> table to be a reference to the <code>Staff</code> table.
Currently, the <code>Staff</code> table doesn&rsquo;t have any column that uniquely identifies each record. For
setting up references, it&rsquo;s a good idea to add one. In this case, we&rsquo;ll add a &ldquo;Full Name&rdquo; column
to the <code>Staff</code> table.</p>
<h2 id="formulas">Formulas<a class="headerlink" href="#formulas" title="Permanent link">#</a></h2>
<p>Click on the &ldquo;Staff&rdquo; page, and add a &ldquo;Full Name&rdquo; column using the column menu or the
<code class="keys"><em>Alt</em> + <strong>=</strong></code> shortcut, and type &ldquo;Full Name&rdquo; in the new column&rsquo;s
header.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="fullname-rename" src="../images/afterschool-program/fullname-rename.png" /></em></span></p>
<p>Create a formula by typing in a value into any cell in the new column, starting with the equal
sign (“=”). Enter the formula as <code class="formula">$First_Name + ", " + $Last_Name</code>. You may use Excel-like syntax
to the same effect: <code class="formula">CONCAT($First_Name, ", ", $Last_Name)</code>.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="fullname-formula" src="../images/afterschool-program/fullname-formula.png" /></em></span></p>
<ul>
<li>In Grist, a formula always applies to every record in the table.</li>
<li>Grist supports Python in formulas, and most Excel functions, which have uppercase names.</li>
</ul>
<p>Because formulas apply to every row, you should see the <em>Full Name</em> column automatically filled.</p>
<p><img alt="fullname-result" src="../images/afterschool-program/fullname-result.png" /></p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">#</a></h2>
<p>Click on the &ldquo;Classes&rdquo; page again, and open “Column Options” for the <em>Instructor</em> column. We&rsquo;ll
turn it into a reference to <code>Staff</code>.</p>
<p><img alt="instructor-col" src="../images/afterschool-program/instructor-col.png" /></p>
<p>In the right-side panel, set the column type to “Reference” (in database terms, this is known as a
“foreign key”), and set the referenced table to “Staff”. For the &ldquo;SHOW COLUMN&rdquo; dropdown, select
&ldquo;Full Name&rdquo;, which is the new column we just added.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="instructor-ref" src="../images/afterschool-program/instructor-ref.png" /></em></span></p>
<p>Click the &ldquo;Apply&rdquo; button to complete this change of the column&rsquo;s type (if the column is empty,
there is no confirmation step).</p>
<p>You can now assign an instructor to any class. Click on a cell in the <em>Instructor</em> column. You
can hit <code class="keys"><em>Enter</em></code> and choose from among the available
instructors in the <code>Staff</code> table, or start typing to use auto-complete.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="instructor-autocomplete" src="../images/afterschool-program/instructor-autocomplete.png" /></em></span></p>
<p>Next, we will continue with students and their enrollments.</p>
<h2 id="students">Students<a class="headerlink" href="#students" title="Permanent link">#</a></h2>
<p>Each class has a number of students. So, we’ll need a table of students. Again, add a new empty
table, rename it to &ldquo;Students&rdquo;, and fill it with the students’ names, grade levels, etc. Or
import <a href="/afterschool-program/Students.csv">Students.csv</a> to use sample data and save a few steps.</p>
<p><img alt="students-table" src="../images/afterschool-program/students-table.png" /></p>
<p>Let&rsquo;s add here a &ldquo;Full Name&rdquo; formula column, just like in the <code>Staff</code> table. It will come in handy.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="students-fullname" src="../images/afterschool-program/students-fullname.png" /></em></span></p>
<h2 id="many-to-many-relationships">Many-to-Many Relationships<a class="headerlink" href="#many-to-many-relationships" title="Permanent link">#</a></h2>
<p>A student can take more than one class. Let&rsquo;s remember also that there are classes in the past and in the
future, and keeping this historical data is valuable. So, for each student, there may be multiple
classes, and in each class, there are multiple students.</p>
<p>A good way to model such a relation is by adding the concept of an “enrollment” and a new
<code>Enrollments</code> table. An “enrollment” represents one student being enrolled in one class. It has some
useful properties of its own: the enrollment status (Confirmed, Waitlisted, or Cancelled), whether
they have paid for the class, and perhaps more.</p>
<p>In database design, this is known as a “many-to-many” relationship. The extra table is known as a
“join” table. Essentially, it adds a record for each student-class connection, and turns the
“many-to-many” relationship into two “one-to-many” relationships.</p>
<p>This relationship:</p>
<p class="screenshot-half"><span class="screenshot-full"><em><img alt="many-to-many-cross" src="../images/many-to-many-cross.png" /></em></span></p>
<p>becomes this:</p>
<p class="screenshot-half"><span class="screenshot-full"><em><img alt="many-to-many-join" src="../images/many-to-many-join.png" /></em></span></p>
<p>So, let’s add a new table, name it &ldquo;Enrollments&rdquo;, and add the columns we need. Here too, to follow
along, you may import sample data from <a href="/afterschool-program/Enrollments.csv">Enrollments.csv</a>.</p>
<p><img alt="enrollments-table" src="../images/afterschool-program/enrollments-table.png" /></p>
<p>In Column Options for the column <em>Student</em>, set the Column Type to &ldquo;Reference&rdquo;, set the referenced table to <code>Students</code>, and select &ldquo;Full Name&rdquo; as the column to show.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="enrollments-student-col" src="../images/afterschool-program/enrollments-student-col.png" /></em></span></p>
<p>For the column <em>Class</em>, set the Column Type to &ldquo;Reference&rdquo;, the referenced table to <code>Classes</code>, and
select &ldquo;Class Code&rdquo; as the column to show.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="enrollments-class-col" src="../images/afterschool-program/enrollments-class-col.png" /></em></span></p>
<p>It&rsquo;s possible to enter enrollment data by adding records to this table and using auto-complete in
the <em>Student</em> and <em>Class</em> column. Below, we will set up a much more convenient way to enroll
students.</p>
<h2 id="class-view">Class View<a class="headerlink" href="#class-view" title="Permanent link">#</a></h2>
<p>One of our goals in the Planning stage was to see a list of enrolled students for each class.
Now that the data tables are in place, we can create a page that does this.</p>
<p>Click &ldquo;Add New&rdquo;, then &ldquo;Add Page&rdquo; to open the widget picker. Select to show a table of <code>Classes</code>,
and click &ldquo;Add Page&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="classlist-picker1" src="../images/afterschool-program/classlist-picker1.png" /></em></span></p>
<p>The new page shows a list of classes. Let&rsquo;s rename this page &ldquo;Class View&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="classlist-renaming" src="../images/afterschool-program/classlist-renaming.png" /></em></span></p>
<p>Next, add the <code>Enrollments</code> table linked to the table of classes. Click &ldquo;Add New&rdquo;
again, then &ldquo;Add Widget to Page&rdquo;. In the widget picker, select to show a table of <code>Enrollments</code>.
For &ldquo;SELECT BY&rdquo;, choose &ldquo;CLASSES&rdquo;, and click &ldquo;Add to Page&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="classlist-picker2" src="../images/afterschool-program/classlist-picker2.png" /></em></span></p>
<p>We get two tables side-by-side. Selecting a class shows all enrollments in that class, each of
which references a particular student and includes some other enrollment info.</p>
<p><img alt="classlist-page1" src="../images/afterschool-program/classlist-page1.png" /></p>
<p>We can go a step further to make this view convenient for us. Let&rsquo;s add a Class card to this view.
Click &ldquo;Add New&rdquo; and &ldquo;Add Widget to Page&rdquo;. In the widget picker, select widget &ldquo;Card&rdquo; for the
<code>Classes</code> data. For &ldquo;SELECT BY&rdquo;, choose &ldquo;CLASSES&rdquo; again, and click &ldquo;Add to Page&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="classlist-picker3" src="../images/afterschool-program/classlist-picker3.png" /></em></span></p>
<p>We can similarly add a card for the instructor leading this class. Again, click &ldquo;Add New&rdquo; &gt; &ldquo;Add
Widget to Page&rdquo;, and select &ldquo;Card&rdquo; for the <code>Staff</code> data. For &ldquo;SELECT BY&rdquo;, you can now pick
&ldquo;CLASSES • Instructor&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="classlist-picker4" src="../images/afterschool-program/classlist-picker4.png" /></em></span></p>
<p>You can change the look of the new cards. Click the three-dot menu on the top right of the Card
you&rsquo;d like to change, and choose &ldquo;Widget options&rdquo;. Find the &ldquo;Theme&rdquo; dropdown in the right panel,
and select &ldquo;Compact&rdquo;.</p>
<p><img alt="classlist-theme" src="../images/afterschool-program/classlist-theme.png" /></p>
<p>Here is what we now have in Class View page:</p>
<p><img alt="classlist-page2" src="../images/afterschool-program/classlist-page2.png" /></p>
<p>It&rsquo;s a good time to clean up this page by hiding columns and fields that are duplicated or
distracting. Check out <a href="page-widgets.md/#configuring-field-lists">Configuring field lists</a> for an
efficient way to select which fields to show, and <a href="../custom-layouts/">Custom Layouts</a> for
rearranging widgets on the page.</p>
<p><img alt="classlist-page3" src="../images/afterschool-program/classlist-page3.png" /></p>
<h2 id="enrollment-view">Enrollment View<a class="headerlink" href="#enrollment-view" title="Permanent link">#</a></h2>
<p>Our other stated goal was a convenient way to enroll a student, and to see or adjust a given
student&rsquo;s enrollments.</p>
<p>Let&rsquo;s add a page for this. Click &ldquo;Add New&rdquo; &gt; &ldquo;Add Page&rdquo;, and select a table of <code>Students</code>. We&rsquo;ll
rename the new page to &ldquo;Enrollment View&rdquo;.</p>
<p><img alt="enrollments-view1" src="../images/afterschool-program/enrollments-view1.png" /></p>
<p>When we select a student here, we&rsquo;d like to see all enrollments for this student. So click &ldquo;Add
New&rdquo; &gt; &ldquo;Add Widget to Page&rdquo;, and add a table of <code>Enrollments</code>. To link the new widget to the
Students widget in the page, set the &ldquo;SELECT BY&rdquo; dropdown to &ldquo;STUDENTS&rdquo;, and click &ldquo;Add to Page&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="enrollments-picker1" src="../images/afterschool-program/enrollments-picker1.png" /></em></span></p>
<p>Now you can click on a student’s name on the left and see the classes that student is enrolled in
on the right. You can enroll the selected student into a class by simply entering a class code
in the special blank row at the bottom of the enrollments list. As usual, the <em>Class</em> reference
column offers auto-complete.</p>
<p><img alt="enrollments-view2" src="../images/afterschool-program/enrollments-view2.png" /></p>
<p>You can hide the &ldquo;Student&rdquo; column in &ldquo;ENROLLMENTS&rdquo; table, since it will always show the selected
student anyway.</p>
<p>If you&rsquo;d like to include more info about the classes in the Enrollments table, select Column
Options for the <em>Class</em> column, and click &ldquo;+ Add Column&rdquo; in the side panel.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="enrollments-times" src="../images/afterschool-program/enrollments-times.png" /></em></span></p>
<p>Any of the fields associated with a class are available. If you examine the columns you add this
way, you&rsquo;ll see that they are simply formulas of the form <code class="formula">$Class.Times</code>.</p>
<p><img alt="enrollments-view3" src="../images/afterschool-program/enrollments-view3.png" /></p>
<h2 id="adding-layers">Adding Layers<a class="headerlink" href="#adding-layers" title="Permanent link">#</a></h2>
<p>If you are working with children, you are talking to their parents. You’ll need to have the
parents’ names and contact info, which you can add as columns to the students table.</p>
<p>You’re likely to find that some parents have multiple children that enroll in classes together.
Recognizing the parent-child relationship in your database may seem like a complex step, but it
will likely simplify your daily workflow.</p>
<p>So, let’s add one more table: <code>Families</code>. We’ll include the parent name and contact info, and link
each child to a record here. You can import sample data from
<a href="/afterschool-program/Families.csv">Families.csv</a>.</p>
<p><img alt="families1" src="../images/afterschool-program/families1.png" /></p>
<p>Note that we added a <em>Full Name</em> column here as for other tables that list people.</p>
<p>In the Students table, we’ll add a column named &ldquo;Family&rdquo;, and make it a Reference to <code>Families</code>.</p>
<p><img alt="student-families" src="../images/afterschool-program/student-families.png" /></p>
<p>The example data already has families filled in, and conversion to reference looks up the text to
set correct references. If you were entering new data, you could link students to families using
auto-complete as with other reference columms.</p>
<p>Let’s change our “Enrollment View” to list families first. This way, when a parent calls, you can
pick the right record and see all of their children and enrollments for each child.</p>
<p>In the “Enrollment View” page, click “Add New” &gt; &ldquo;Add Widget to Page&rdquo;. Select to show a table of
<code>Families</code>.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="enrollments-picker2" src="../images/afterschool-program/enrollments-picker2.png" /></em></span></p>
<p>Rearrange the widgets to have Families on the left, and Students and Enrollments to the right of
it.</p>
<p><img alt="enrollments-view4" src="../images/afterschool-program/enrollments-view4.png" /></p>
<p>Now link students to Families: click the three-dot menu on the top right of the STUDENTS table,
and choose &ldquo;Data Selection&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="enrollments-menu" src="../images/afterschool-program/enrollments-menu.png" /></em></span></p>
<p>In the side panel, you can set “SELECT BY” widget to &ldquo;FAMILIES&rdquo;.</p>
<p class="screenshot-half"><span class="screenshot-large"><em><img alt="enrollments-select-by" src="../images/afterschool-program/enrollments-select-by.png" /></em></span></p>
<p>Finally, you can add Card widgets for details of the selected family, and of the selected student,
and rearrange the widgets on the page to create a layout that’s perfect for talking to a parent.</p>
<p><img alt="enrollments-view5" src="../images/afterschool-program/enrollments-view5.png" /></p>
<p>You select a parent, see their children, and then select a child to see their enrollments. It’s
easy to add an enrollment record for a new class, or to change a record (e.g. mark it as
“cancelled”), to add another child, or to add a new family.</p>
<h2 id="example-document">Example Document<a class="headerlink" href="#example-document" title="Permanent link">#</a></h2>
<p>The “Afterschool Program” example includes everything described above and a bit more.</p>
<p>In particular, it adds a <em>Count</em> field to Classes to calculate the number of enrolled students, and a <em>Spots Left</em> field to show the number of spots remaining, by comparing <em>Count</em> to <em>Max_Students</em>:</p>
<ul>
<li>The formula for <em>Count</em> is <code class="formula">len(Enrollments.lookupRecords(Class=$id, Status="Confirmed"))</code>.</li>
<li>The formula for <em>Spots Left</em> is <code class="formula">max($Max_Students - $Count, 0) or "Full"</code>.</li>
</ul>
<p class="screenshot-half"><span class="screenshot-full"><em><img alt="spots-left" src="../images/afterschool-program/spots-left.png" /></em></span></p>
<p>These make for a more useful Class View page, where it&rsquo;s now easy to see at a glance which classes
have spots remaining.</p>

  <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>